(window.webpackJsonp=window.webpackJsonp||[]).push([[318],{194:function(e,t,r){"use strict";r.d(t,"a",(function(){return R})),r.d(t,"b",(function(){return K})),r.d(t,"c",(function(){return C})),r.d(t,"d",(function(){return A}));var o=r(267),n=r(70),h=r(342),c=r(343),l=r(219);const d=e=>null==e,f=e=>!d(e),m=(e,a,b)=>v(a,e)===v(b,e);function k(u){return u&&u.length&&new RegExp(["^\\/([a-zA-Z0-9@\\-%_~.:]","[/a-zA-Z0-9@\\-%_~.:]*)?","([?][^#]*)?(#[^#]*)?$"].join("")).test(u)}function y(e){const t={},r=e.split("&");for(let i=0;i<r.length;i++){const e=r[i].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return t}function x(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>encodeURIComponent(e)+(null!=t?"="+encodeURIComponent(t):""))).join("&")}function _(e,t,r){return e.matched.some((e=>Object.values(e.components).some((component=>component.options&&component.options[t]===r))))}function v(path="",e){let t=path.split("?")[0];return e&&e.base&&(t=t.replace(e.base,"/")),"/"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),t=t.replace(/\/+/g,"/"),t}function $(e){return"string"==typeof e?e:JSON.stringify(e)}function S(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function w(e,t){if(!t||!e||"object"!=typeof e)return e;if(t in e)return e[t];const r=Array.isArray(t)?t:(t+"").split(".");let o=e;for(;r.length&&o;)o=o[r.shift()];return o}function U(e,t){return e&&t&&"string"==typeof e&&!e.startsWith(t)?t+" "+e:e}function E(...e){return e.join("/").replace(/[/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function P(e){let t="";for(let i=0;i<e;i++)t+=T.charAt(Math.floor(62*Math.random()));return t}class I{constructor(e,t){this.ctx=e,this.options=t,this._initState()}setUniversal(e,t){return d(t)?this.removeUniversal(e):(this.setCookie(e,t),this.setLocalStorage(e,t),this.setState(e,t),t)}getUniversal(e){let t;return d(t)&&(t=this.getCookie(e)),d(t)&&(t=this.getLocalStorage(e)),d(t)&&(t=this.getState(e)),t}syncUniversal(e,t){let r=this.getUniversal(e);return d(r)&&f(t)&&(r=t),f(r)&&this.setUniversal(e,r),r}removeUniversal(e){this.removeState(e),this.removeLocalStorage(e),this.removeCookie(e)}_initState(){if(n.set(this,"_state",{}),this._useVuex=this.options.vuex&&!!this.ctx.store,this._useVuex){const e={namespaced:!0,state:()=>this.options.initialState,mutations:{SET(e,t){n.set(e,t.key,t.value)}}};this.ctx.store.registerModule(this.options.vuex.namespace,e,{preserveState:Boolean(this.ctx.store.state[this.options.vuex.namespace])}),this.state=this.ctx.store.state[this.options.vuex.namespace]}else n.set(this,"state",{}),console.warn("[AUTH] The Vuex Store is not activated. This might cause issues in auth module behavior, like redirects not working properly.To activate it, see https://nuxtjs.org/docs/2.x/directory-structure/store")}setState(e,t){return"_"===e[0]?n.set(this._state,e,t):this._useVuex?this.ctx.store.commit(this.options.vuex.namespace+"/SET",{key:e,value:t}):n.set(this.state,e,t),t}getState(e){return"_"!==e[0]?this.state[e]:this._state[e]}watchState(e,t){if(this._useVuex)return this.ctx.store.watch((t=>w(t[this.options.vuex.namespace],e)),t)}removeState(e){this.setState(e,void 0)}setLocalStorage(e,t){if(d(t))return this.removeLocalStorage(e);if(!this.isLocalStorageEnabled())return;const r=this.getPrefix()+e;try{localStorage.setItem(r,$(t))}catch(e){if(!this.options.ignoreExceptions)throw e}return t}getLocalStorage(e){if(!this.isLocalStorageEnabled())return;const t=this.getPrefix()+e;return S(localStorage.getItem(t))}removeLocalStorage(e){if(!this.isLocalStorageEnabled())return;const t=this.getPrefix()+e;localStorage.removeItem(t)}getCookies(){if(!this.isCookiesEnabled())return;const e=document.cookie;return h.parse(e||"")||{}}setCookie(e,t,r={}){if(!this.options.cookie)return;if(!this.isCookiesEnabled())return;const o=(void 0!==r.prefix?r.prefix:this.options.cookie.prefix)+e,n=Object.assign({},this.options.cookie.options,r),c=$(t);d(t)&&(n.maxAge=-1),"number"==typeof n.expires&&(n.expires=new Date(Date.now()+864e5*n.expires));const l=h.serialize(o,c,n);return document.cookie=l,t}getCookie(e){if(!this.options.cookie)return;if(!this.isCookiesEnabled())return;const t=this.options.cookie.prefix+e,r=this.getCookies();return S(r[t]?decodeURIComponent(r[t]):void 0)}removeCookie(e,t){this.setCookie(e,void 0,t)}getPrefix(){if(!this.options.localStorage)throw new Error("Cannot get prefix; localStorage is off");return this.options.localStorage.prefix}isLocalStorageEnabled(){if(!this.options.localStorage)return!1;const e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return this.options.ignoreExceptions||console.warn("[AUTH] Local storage is enabled in config, but browser doesn't support it"),!1}}isCookiesEnabled(){return!!this.options.cookie&&(!!window.navigator.cookieEnabled||(console.warn("[AUTH] Cookies is enabled in config, but browser doesn't support it"),!1))}}class R{constructor(e,t){this.strategies={},this._errorListeners=[],this._redirectListeners=[],this.ctx=e,this.options=t;const r=new I(e,{...t,initialState:{user:null,loggedIn:!1}});this.$storage=r,this.$state=r.state}get state(){return this._stateWarnShown||(this._stateWarnShown=!0,console.warn("[AUTH] $auth.state is deprecated. Please use $auth.$state or top level props like $auth.loggedIn")),this.$state}get strategy(){return this.getStrategy()}getStrategy(e=!0){if(e){if(!this.$state.strategy)throw new Error("No strategy is set!");if(!this.strategies[this.$state.strategy])throw new Error("Strategy not supported: "+this.$state.strategy)}return this.strategies[this.$state.strategy]}get user(){return this.$state.user}get loggedIn(){return this.$state.loggedIn}get busy(){return this.$storage.getState("busy")}async init(){if(this.options.resetOnError&&this.onError(((...e)=>{("function"!=typeof this.options.resetOnError||this.options.resetOnError(...e))&&this.reset()})),this.$storage.syncUniversal("strategy",this.options.defaultStrategy),!this.getStrategy(!1)&&(this.$storage.setUniversal("strategy",this.options.defaultStrategy),!this.getStrategy(!1)))return Promise.resolve();try{await this.mounted()}catch(e){this.callOnError(e)}finally{this.options.watchLoggedIn&&this.$storage.watchState("loggedIn",(e=>{_(this.ctx.route,"auth",!1)||this.redirect(e?"home":"logout")}))}}getState(e){return this._getStateWarnShown||(this._getStateWarnShown=!0,console.warn("[AUTH] $auth.getState is deprecated. Please use $auth.$storage.getState() or top level props like $auth.loggedIn")),this.$storage.getState(e)}registerStrategy(e,t){this.strategies[e]=t}setStrategy(e){if(e===this.$storage.getUniversal("strategy"))return Promise.resolve();if(!this.strategies[e])throw new Error(`Strategy ${e} is not defined!`);return this.reset(),this.$storage.setUniversal("strategy",e),this.mounted()}mounted(...e){return this.getStrategy().mounted?Promise.resolve(this.getStrategy().mounted(...e)).catch((e=>(this.callOnError(e,{method:"mounted"}),Promise.reject(e)))):this.fetchUserOnce()}loginWith(e,...t){return this.setStrategy(e).then((()=>this.login(...t)))}login(...e){return this.getStrategy().login?this.wrapLogin(this.getStrategy().login(...e)).catch((e=>(this.callOnError(e,{method:"login"}),Promise.reject(e)))):Promise.resolve()}fetchUser(...e){return this.getStrategy().fetchUser?Promise.resolve(this.getStrategy().fetchUser(...e)).catch((e=>(this.callOnError(e,{method:"fetchUser"}),Promise.reject(e)))):Promise.resolve()}logout(...e){return this.getStrategy().logout?Promise.resolve(this.getStrategy().logout(...e)).catch((e=>(this.callOnError(e,{method:"logout"}),Promise.reject(e)))):(this.reset(),Promise.resolve())}setUserToken(e,t){return this.getStrategy().setUserToken?Promise.resolve(this.getStrategy().setUserToken(e,t)).catch((e=>(this.callOnError(e,{method:"setUserToken"}),Promise.reject(e)))):(this.getStrategy().token.set(e),Promise.resolve())}reset(...e){return this.getStrategy().reset||(this.setUser(!1),this.getStrategy().token.reset(),this.getStrategy().refreshToken.reset()),this.getStrategy().reset(...e)}refreshTokens(){return this.getStrategy().refreshController?Promise.resolve(this.getStrategy().refreshController.handleRefresh()).catch((e=>(this.callOnError(e,{method:"refreshTokens"}),Promise.reject(e)))):Promise.resolve()}check(...e){return this.getStrategy().check?this.getStrategy().check(...e):{valid:!0}}fetchUserOnce(...e){return this.$state.user?Promise.resolve():this.fetchUser(...e)}setUser(e){this.$storage.setState("user",e);let t={valid:Boolean(e)};t.valid&&(t=this.check()),this.$storage.setState("loggedIn",t.valid)}request(e,t={}){const r="object"==typeof t?Object.assign({},t,e):e;if(""===r.baseURL&&(r.baseURL=o(this.ctx.req)),this.ctx.app.$axios)return this.ctx.app.$axios.request(r).catch((e=>(this.callOnError(e,{method:"request"}),Promise.reject(e))));console.error("[AUTH] add the @nuxtjs/axios module to nuxt.config file")}requestWith(e,t,r){const o=this.getStrategy().token.get(),n=Object.assign({},r,t),h=this.strategies[e].options.token.name||"Authorization";return n.headers||(n.headers={}),!n.headers[h]&&f(o)&&o&&"string"==typeof o&&(n.headers[h]=o),this.request(n)}wrapLogin(e){return this.$storage.setState("busy",!0),this.error=null,Promise.resolve(e).then((e=>(this.$storage.setState("busy",!1),e))).catch((e=>(this.$storage.setState("busy",!1),Promise.reject(e))))}onError(e){this._errorListeners.push(e)}callOnError(e,t={}){this.error=e;for(const r of this._errorListeners)r(e,t)}redirect(e,t=!1){if(!this.options.redirect)return;const r=this.options.fullPathRedirect?this.ctx.route.fullPath:this.ctx.route.path;let o=this.options.redirect[e];if(o){if(this.options.rewriteRedirects&&("login"===e&&k(r)&&!m(this.ctx,o,r)&&this.$storage.setUniversal("redirect",r),"home"===e)){const e=this.$storage.getUniversal("redirect");this.$storage.setUniversal("redirect",null),k(e)&&(o=e)}o=this.callOnRedirect(o,r)||o,m(this.ctx,o,r)||(t?(k(o)&&!o.includes(this.ctx.base)&&(o=v("/"+this.ctx.base+"/"+o)),window.location.replace(o)):this.ctx.redirect(o,this.ctx.query))}}onRedirect(e){this._redirectListeners.push(e)}callOnRedirect(e,t){for(const r of this._redirectListeners)e=r(e,t)||e;return e}hasScope(e){const t=this.$state.user&&w(this.$state.user,this.options.scopeKey);return!!t&&(Array.isArray(t)?t.includes(e):Boolean(w(t,e)))}}const A=async e=>{if(_(e.route,"auth",!1))return;const t=function(e,t=[]){return[].concat(...e.matched.map((function(e,r){return Object.keys(e.components).map((function(o){return t.push(r),e.components[o]}))})))}(e.route,[]);if(!t.length)return;const{login:r,callback:o}=e.$auth.options.redirect,n=_(e.route,"auth","guest"),h=t=>v(e.route.path,e)===v(t,e);if(e.$auth.$state.loggedIn){const{tokenExpired:t,refreshTokenExpired:o,isRefreshable:c}=e.$auth.check(!0);if((!r||h(r)||n)&&e.$auth.redirect("home"),o)e.$auth.reset();else if(t)if(c)try{await e.$auth.refreshTokens()}catch(t){e.$auth.reset()}else e.$auth.reset()}else n||o&&h(o)||e.$auth.redirect("login")};Error;class C extends Error{constructor(){super("Both token and refresh token have expired. Your request was aborted."),this.name="ExpiredAuthSessionError"}}class O{constructor(e){this.scheme=e,this._refreshPromise=null,this.$auth=e.$auth}handleRefresh(){return this._refreshPromise?this._refreshPromise:this._doRefresh()}_doRefresh(){return this._refreshPromise=new Promise(((e,t)=>{this.scheme.refreshTokens().then((t=>{this._refreshPromise=null,e(t)})).catch((e=>{this._refreshPromise=null,t(e)}))})),this._refreshPromise}}var L,j;(j=L||(L={})).UNKNOWN="UNKNOWN",j.VALID="VALID",j.EXPIRED="EXPIRED";class H{constructor(e,t){this._status=this._calculate(e,t)}unknown(){return L.UNKNOWN===this._status}valid(){return L.VALID===this._status}expired(){return L.EXPIRED===this._status}_calculate(e,t){const r=Date.now();try{if(!e||!t)return L.UNKNOWN}catch(e){return L.UNKNOWN}return r<(t-=500)?L.VALID:L.EXPIRED}}class N{constructor(e,t){this.scheme=e,this.$storage=t}get(){const e=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.getUniversal(e)}set(e){const t=U(e,this.scheme.options.refreshToken.type);return this._setToken(t),this._updateExpiration(t),t}sync(){const e=this._syncToken();return this._syncExpiration(),e}reset(){this._setToken(!1),this._setExpiration(!1)}status(){return new H(this.get(),this._getExpiration())}_getExpiration(){const e=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.getUniversal(e)}_setExpiration(e){const t=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncExpiration(){const e=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.syncUniversal(e)}_updateExpiration(e){let t;const r=Date.now(),o=1e3*Number(this.scheme.options.refreshToken.maxAge),n=o?r+o:0;try{t=1e3*l(e+"").exp||n}catch(e){if(t=n,!e||"InvalidTokenError"!==e.name)throw e}return this._setExpiration(t||!1)}_setToken(e){const t=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncToken(){const e=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.syncUniversal(e)}}class V{constructor(e,t){this.scheme=e,this.axios=t,this.interceptor=null}setHeader(e){this.scheme.options.token.global&&this.axios.setHeader(this.scheme.options.token.name,e)}clearHeader(){this.scheme.options.token.global&&this.axios.setHeader(this.scheme.options.token.name,!1)}initializeRequestInterceptor(e){this.interceptor=this.axios.interceptors.request.use((async t=>{if(!this._needToken(t)||t.url===e)return t;const{valid:r,tokenExpired:o,refreshTokenExpired:n,isRefreshable:h}=this.scheme.check(!0);let c=r;if(n)throw this.scheme.reset(),new C;if(o){if(!h)throw this.scheme.reset(),new C;c=await this.scheme.refreshTokens().then((()=>!0)).catch((()=>{throw this.scheme.reset(),new C}))}const l=this.scheme.token.get();if(!c){if(!l&&this._requestHasAuthorizationHeader(t))throw new C;return t}return this._getUpdatedRequestConfig(t,l)}))}reset(){this.axios.interceptors.request.eject(this.interceptor),this.interceptor=null}_needToken(e){const t=this.scheme.options;return t.token.global||Object.values(t.endpoints).some((t=>"object"==typeof t?t.url===e.url:t===e.url))}_getUpdatedRequestConfig(e,t){return"string"==typeof t&&(e.headers[this.scheme.options.token.name]=t),e}_requestHasAuthorizationHeader(e){return!!e.headers.common[this.scheme.options.token.name]}}class D{constructor(e,t){this.scheme=e,this.$storage=t}get(){const e=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.getUniversal(e)}set(e){const t=U(e,this.scheme.options.token.type);return this._setToken(t),this._updateExpiration(t),"string"==typeof t&&this.scheme.requestHandler.setHeader(t),t}sync(){const e=this._syncToken();return this._syncExpiration(),"string"==typeof e&&this.scheme.requestHandler.setHeader(e),e}reset(){this.scheme.requestHandler.clearHeader(),this._setToken(!1),this._setExpiration(!1)}status(){return new H(this.get(),this._getExpiration())}_getExpiration(){const e=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.getUniversal(e)}_setExpiration(e){const t=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncExpiration(){const e=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.syncUniversal(e)}_updateExpiration(e){let t;const r=Date.now(),o=1e3*Number(this.scheme.options.token.maxAge),n=o?r+o:0;try{t=1e3*l(e+"").exp||n}catch(e){if(t=n,!e||"InvalidTokenError"!==e.name)throw e}return this._setExpiration(t||!1)}_setToken(e){const t=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncToken(){const e=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.syncUniversal(e)}}class W{constructor(e,...t){this.$auth=e,this.options=t.reduce(((p,e)=>c(p,e)),{})}get name(){return this.options.name}}const z={name:"oauth2",accessType:null,redirectUri:null,logoutRedirectUri:null,clientId:null,audience:null,grantType:null,responseMode:null,acrValues:null,autoLogout:!1,endpoints:{logout:null,authorization:null,token:null,userInfo:null},scope:[],token:{property:"access_token",type:"Bearer",name:"Authorization",maxAge:1800,global:!0,prefix:"_token.",expirationPrefix:"_token_expiration."},refreshToken:{property:"refresh_token",maxAge:2592e3,prefix:"_refresh_token.",expirationPrefix:"_refresh_token_expiration."},user:{property:!1},responseType:"token",codeChallengeMethod:"implicit"};class M extends W{constructor(e,t,...r){super(e,t,...r,z),this.req=e.ctx.req,this.token=new D(this,this.$auth.$storage),this.refreshToken=new N(this,this.$auth.$storage),this.refreshController=new O(this),this.requestHandler=new V(this,this.$auth.ctx.$axios)}get scope(){return Array.isArray(this.options.scope)?this.options.scope.join(" "):this.options.scope}get redirectURI(){const path=v((this.$auth.ctx.base||"")+"/"+this.$auth.options.redirect.callback);return this.options.redirectUri||E(o(this.req),path)}get logoutRedirectURI(){return this.options.logoutRedirectUri||E(o(this.req),this.$auth.options.redirect.logout)}check(e=!1){const t={valid:!1,tokenExpired:!1,refreshTokenExpired:!1,isRefreshable:!0},r=this.token.sync();if(this.refreshToken.sync(),!r)return t;if(!e)return t.valid=!0,t;const o=this.token.status();return this.refreshToken.status().expired()?(t.refreshTokenExpired=!0,t):o.expired()?(t.tokenExpired=!0,t):(t.valid=!0,t)}async mounted(){const{tokenExpired:e,refreshTokenExpired:t}=this.check(!0);(t||e&&this.options.autoLogout)&&this.$auth.reset(),this.requestHandler.initializeRequestInterceptor(this.options.endpoints.token);if(!await this._handleCallback())return this.$auth.fetchUserOnce()}reset(){this.$auth.setUser(!1),this.token.reset(),this.refreshToken.reset(),this.requestHandler.reset()}async login(e={}){const t={protocol:"oauth2",response_type:this.options.responseType,access_type:this.options.accessType,client_id:this.options.clientId,redirect_uri:this.redirectURI,scope:this.scope,state:e.state||P(10),code_challenge_method:this.options.codeChallengeMethod,...e.params};if(this.options.audience&&(t.audience=this.options.audience),(t.response_type.includes("token")||t.response_type.includes("id_token"))&&(t.nonce=e.nonce||P(10)),t.code_challenge_method)switch(t.code_challenge_method){case"plain":case"S256":{const e=this.generateRandomString();this.$auth.$storage.setUniversal(this.name+".pkce_state",e);const r=this.generateRandomString();this.$auth.$storage.setUniversal(this.name+".pkce_code_verifier",r);const o=await this.pkceChallengeFromVerifier(r,"S256"===t.code_challenge_method);t.code_challenge=window.encodeURIComponent(o)}}this.options.responseMode&&(t.response_mode=this.options.responseMode),this.options.acrValues&&(t.acr_values=this.options.acrValues),this.$auth.$storage.setUniversal(this.name+".state",t.state);const r=this.options.endpoints.authorization+"?"+x(t);window.location.replace(r)}logout(){if(this.options.endpoints.logout){const e={client_id:this.options.clientId+"",logout_uri:this.logoutRedirectURI},t=this.options.endpoints.logout+"?"+x(e);window.location.replace(t)}return this.$auth.reset()}async fetchUser(){if(!this.check().valid)return;if(!this.options.endpoints.userInfo)return void this.$auth.setUser({});const e=await this.$auth.requestWith(this.name,{url:this.options.endpoints.userInfo});this.$auth.setUser(w(e.data,this.options.user.property))}async _handleCallback(){if(this.$auth.options.redirect&&v(this.$auth.ctx.route.path,this.$auth.ctx)!==v(this.$auth.options.redirect.callback,this.$auth.ctx))return;const e=y(this.$auth.ctx.route.hash.substr(1)),t=Object.assign({},this.$auth.ctx.route.query,e);let r,o=t[this.options.token.property];this.options.refreshToken.property&&(r=t[this.options.refreshToken.property]);const n=this.$auth.$storage.getUniversal(this.name+".state");if(this.$auth.$storage.setUniversal(this.name+".state",null),!n||t.state===n){if("code"===this.options.responseType&&t.code){let e;this.options.codeChallengeMethod&&"implicit"!==this.options.codeChallengeMethod&&(e=this.$auth.$storage.getUniversal(this.name+".pkce_code_verifier"),this.$auth.$storage.setUniversal(this.name+".pkce_code_verifier",null));const n=await this.$auth.request({method:"post",url:this.options.endpoints.token,baseURL:"",data:x({code:t.code,client_id:this.options.clientId+"",redirect_uri:this.redirectURI,response_type:this.options.responseType,audience:this.options.audience,grant_type:this.options.grantType,code_verifier:e})});o=w(n.data,this.options.token.property)||o,r=w(n.data,this.options.refreshToken.property)||r}if(o&&o.length)return this.token.set(o),r&&r.length&&this.refreshToken.set(r),this.$auth.options.watchLoggedIn?(this.$auth.redirect("home",!0),!0):void 0}}async refreshTokens(){const e=this.refreshToken.get();if(!e)return;if(this.refreshToken.status().expired())throw this.$auth.reset(),new C;this.requestHandler.clearHeader();const t=await this.$auth.request({method:"post",url:this.options.endpoints.token,baseURL:"",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:x({refresh_token:(r=e,o=this.options.token.type,r&&o&&"string"==typeof r?r.replace(o+" ",""):r),scopes:this.scope,client_id:this.options.clientId+"",grant_type:"refresh_token"})}).catch((e=>(this.$auth.callOnError(e,{method:"refreshToken"}),Promise.reject(e))));var r,o;return this.updateTokens(t),t}updateTokens(e){const t=w(e.data,this.options.token.property),r=w(e.data,this.options.refreshToken.property);this.token.set(t),r&&this.refreshToken.set(r)}async pkceChallengeFromVerifier(e,t){if(t){const t=await this._sha256(e);return this._base64UrlEncode(t)}return e}generateRandomString(){const e=new Uint32Array(28);return window.crypto.getRandomValues(e),Array.from(e,(e=>("0"+e.toString(16)).substr(-2))).join("")}_sha256(e){const data=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",data)}_base64UrlEncode(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}class K extends M{logout(){this.$auth.reset();const e={client_id:this.options.clientId+"",returnTo:this.logoutRedirectURI},t=this.options.endpoints.logout+"?"+x(e);window.location.replace(t)}}},343:function(e,t,r){"use strict";var o=r(148);function n(e){return null!==e&&"object"===o(e)}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",o=arguments.length>3?arguments[3]:void 0;if(!n(t))return h(e,{},r,o);var c=Object.assign({},t);for(var l in e)if("__proto__"!==l&&"constructor"!==l){var d=e[l];null!=d&&(o&&o(c,l,d,r)||(Array.isArray(d)&&Array.isArray(c[l])?c[l]=c[l].concat(d):n(d)&&n(c[l])?c[l]=h(d,c[l],(r?"".concat(r,"."):"")+l.toString(),o):c[l]=d))}return c}function c(e){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return r.reduce((function(p,t){return h(p,t,"",e)}),{})}}r(60),r(11),r(64);var l=c();l.fn=c((function(e,t,r,o){if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0})),l.arrayFn=c((function(e,t,r,o){if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0})),l.extend=c,e.exports=l},580:function(e,t,r){(function(e){e.installComponents=function(component,e){var r="function"==typeof component.exports?component.exports.extendOptions:component.options;for(var i in"function"==typeof component.exports&&(r.components=component.exports.options.components),r.components=r.components||{},e)r.components[i]=r.components[i]||e[i];r.functional&&function(component,e){if(component.exports[t])return;component.exports[t]=!0;var r=component.exports.render;component.exports.render=function(t,o){return r(t,Object.assign({},o,{_c:function(t,a,b){return o._c(e[t]||t,a,b)}}))}}(component,r.components)};var t="_functionalComponents"}).call(this,r(65))}}]);